#include <string>
#include <cstdint>

static std::string cp8500toUTF8Map[256] = {
/* 0 */ "\x00", /* 263A */ "\xE2\x98\xBA", /* 263B */ "\xE2\x98\xBB", /* 2665 */ "\xE2\x99\xA5",
/* 2666 */ "\xE2\x99\xA6", /* 2663 */ "\xE2\x99\xA3", /* 2660 */ "\xE2\x99\xA0", /* 2022 */ "\xE2\x80\xA2",
/* 25D8 */ "\xE2\x97\x98", /* 25CB */ "\xE2\x97\x8B",
/* according to CP850 U+25D9/"\xE2\x97\x99", mapped to space */ " ",
/* 2642 */ "\xE2\x99\x82",
/* 2640 */ "\xE2\x99\x80", /* 266A */ "\xE2\x99\xAA", /* 266B */ "\xE2\x99\xAB", /* 263C */ "\xE2\x98\xBC",
/* 25BA */ "\xE2\x96\xBA", /* 25C4 */ "\xE2\x97\x84", /* 2195 */ "\xE2\x86\x95", /* 203C */ "\xE2\x80\xBC",
/* B6 */ "\xC2\xB6", /* A7 */ "\xC2\xA7", /* 25AC */ "\xE2\x96\xAC", /* 21A8 */ "\xE2\x86\xA8",
/* 2191 */ "\xE2\x86\x91", /* 2193 */ "\xE2\x86\x93", /* 2192 */ "\xE2\x86\x92", /* 2190 */ "\xE2\x86\x90",
/* 221F */ "\xE2\x88\x9F", /* 2194 */ "\xE2\x86\x94", /* 25B2 */ "\xE2\x96\xB2", /* 25BC */ "\xE2\x96\xBC",
/* 20 */ "\x20", /* 21 */ "\x21", /* 22 */ "\x22", /* 23 */ "\x23",
/* 24 */ "\x24", /* 25 */ "\x25", /* 26 */ "\x26", /* 27 */ "\x27",
/* 28 */ "\x28", /* 29 */ "\x29", /* 2A */ "\x2A", /* 2B */ "\x2B",
/* 2C */ "\x2C", /* 2D */ "\x2D", /* 2E */ "\x2E", /* 2F */ "\x2F",
/* 30 */ "\x30", /* 31 */ "\x31", /* 32 */ "\x32", /* 33 */ "\x33",
/* 34 */ "\x34", /* 35 */ "\x35", /* 36 */ "\x36", /* 37 */ "\x37",
/* 38 */ "\x38", /* 39 */ "\x39", /* 3A */ "\x3A", /* 3B */ "\x3B",
/* 3C */ "\x3C", /* 3D */ "\x3D", /* 3E */ "\x3E", /* 3F */ "\x3F",
/* 40 */ "\x40", /* 41 */ "\x41", /* 42 */ "\x42", /* 43 */ "\x43",
/* 44 */ "\x44", /* 45 */ "\x45", /* 46 */ "\x46", /* 47 */ "\x47",
/* 48 */ "\x48", /* 49 */ "\x49", /* 4A */ "\x4A", /* 4B */ "\x4B",
/* 4C */ "\x4C", /* 4D */ "\x4D", /* 4E */ "\x4E", /* 4F */ "\x4F",
/* 50 */ "\x50", /* 51 */ "\x51", /* 52 */ "\x52", /* 53 */ "\x53",
/* 54 */ "\x54", /* 55 */ "\x55", /* 56 */ "\x56", /* 57 */ "\x57",
/* 58 */ "\x58", /* 59 */ "\x59", /* 5A */ "\x5A", /* 5B */ "\x5B",
/* 5C */ "\x5C", /* 5D */ "\x5D", /* 5E */ "\x5E", /* 5F */ "\x5F",
/* 60 */ "\x60", /* 61 */ "\x61", /* 62 */ "\x62", /* 63 */ "\x63",
/* 64 */ "\x64", /* 65 */ "\x65", /* 66 */ "\x66", /* 67 */ "\x67",
/* 68 */ "\x68", /* 69 */ "\x69", /* 6A */ "\x6A", /* 6B */ "\x6B",
/* 6C */ "\x6C", /* 6D */ "\x6D", /* 6E */ "\x6E", /* 6F */ "\x6F",
/* 70 */ "\x70", /* 71 */ "\x71", /* 72 */ "\x72", /* 73 */ "\x73",
/* 74 */ "\x74", /* 75 */ "\x75", /* 76 */ "\x76", /* 77 */ "\x77",
/* 78 */ "\x78", /* 79 */ "\x79", /* 7A */ "\x7A", /* 7B */ "\x7B",
/* 7C */ "\x7C", /* 7D */ "\x7D", /* 7E */ "\x7E", /* 2302 */ "\xE2\x8C\x82",
/* C7 */ "\xC3\x87", /* FC */ "\xC3\xBC", /* E9 */ "\xC3\xA9", /* E2 */ "\xC3\xA2",
/* E4 */ "\xC3\xA4", /* E0 */ "\xC3\xA0", /* E5 */ "\xC3\xA5", /* E7 */ "\xC3\xA7",
/* EA */ "\xC3\xAA", /* EB */ "\xC3\xAB", /* E8 */ "\xC3\xA8", /* EF */ "\xC3\xAF",
/* EE */ "\xC3\xAE", /* EC */ "\xC3\xAC", /* C4 */ "\xC3\x84", /* C5 */ "\xC3\x85",
/* C9 */ "\xC3\x89", /* E6 */ "\xC3\xA6", /* C6 */ "\xC3\x86", /* F4 */ "\xC3\xB4",
/* F6 */ "\xC3\xB6", /* F2 */ "\xC3\xB2", /* FB */ "\xC3\xBB", /* F9 */ "\xC3\xB9",
/* FF */ "\xC3\xBF", /* D6 */ "\xC3\x96", /* DC */ "\xC3\x9C", /* F8 */ "\xC3\xB8",
/* A3 */ "\xC2\xA3", /* D8 */ "\xC3\x98", /* D7 */ "\xC3\x97", /* 192 */ "\xC6\x92",
/* E1 */ "\xC3\xA1", /* ED */ "\xC3\xAD", /* F3 */ "\xC3\xB3", /* FA */ "\xC3\xBA",
/* F1 */ "\xC3\xB1", /* D1 */ "\xC3\x91", /* AA */ "\xC2\xAA", /* BA */ "\xC2\xBA",
/* BF */ "\xC2\xBF", /* AE */ "\xC2\xAE", /* AC */ "\xC2\xAC", /* BD */ "\xC2\xBD",
/* BC */ "\xC2\xBC", /* A1 */ "\xC2\xA1", /* AB */ "\xC2\xAB", /* BB */ "\xC2\xBB",
/* 2591 */ "\xE2\x96\x91", /* 2592 */ "\xE2\x96\x92", /* 2593 */ "\xE2\x96\x93", /* 2502 */ "\xE2\x94\x82",
/* 2524 */ "\xE2\x94\xA4", /* C1 */ "\xC3\x81", /* C2 */ "\xC3\x82", /* C0 */ "\xC3\x80",
/* A9 */ "\xC2\xA9", /* 2563 */ "\xE2\x95\xA3", /* 2551 */ "\xE2\x95\x91", /* 2557 */ "\xE2\x95\x97",
/* 255D */ "\xE2\x95\x9D", /* A2 */ "\xC2\xA2", /* A5 */ "\xC2\xA5", /* 2510 */ "\xE2\x94\x90",
/* 2514 */ "\xE2\x94\x94", /* 2534 */ "\xE2\x94\xB4", /* 252C */ "\xE2\x94\xAC", /* 251C */ "\xE2\x94\x9C",
/* 2500 */ "\xE2\x94\x80", /* 253C */ "\xE2\x94\xBC", /* E3 */ "\xC3\xA3", /* C3 */ "\xC3\x83",
/* 255A */ "\xE2\x95\x9A", /* 2554 */ "\xE2\x95\x94", /* 2569 */ "\xE2\x95\xA9", /* 2566 */ "\xE2\x95\xA6",
/* 2560 */ "\xE2\x95\xA0", /* 2550 */ "\xE2\x95\x90", /* 256C */ "\xE2\x95\xAC", /* A4 */ "\xC2\xA4",
/* F0 */ "\xC3\xB0", /* D0 */ "\xC3\x90", /* CA */ "\xC3\x8A", /* CB */ "\xC3\x8B",
/* C8 */ "\xC3\x88", /* 131 */ "\xC4\xB1", /* CD */ "\xC3\x8D", /* CE */ "\xC3\x8E",
/* CF */ "\xC3\x8F", /* 2518 */ "\xE2\x94\x98", /* 250C */ "\xE2\x94\x8C", /* 2588 */ "\xE2\x96\x88",
/* 2584 */ "\xE2\x96\x84", /* A6 */ "\xC2\xA6", /* CC */ "\xC3\x8C", /* 2580 */ "\xE2\x96\x80",
/* D3 */ "\xC3\x93", /* DF */ "\xC3\x9F", /* D4 */ "\xC3\x94", /* D2 */ "\xC3\x92",
/* F5 */ "\xC3\xB5", /* D5 */ "\xC3\x95", /* B5 */ "\xC2\xB5", /* FE */ "\xC3\xBE",
/* DE */ "\xC3\x9E", /* DA */ "\xC3\x9A", /* DB */ "\xC3\x9B", /* D9 */ "\xC3\x99",
/* FD */ "\xC3\xBD", /* DD */ "\xC3\x9D", /* AF */ "\xC2\xAF", /* B4 */ "\xC2\xB4",
/* AD */ "\xC2\xAD", /* B1 */ "\xC2\xB1", /* 2017 */ "\xE2\x80\x97", /* BE */ "\xC2\xBE",
/* B6 */ "\xC2\xB6", /* A7 */ "\xC2\xA7", /* F7 */ "\xC3\xB7", /* B8 */ "\xC2\xB8",
/* B0 */ "\xC2\xB0", /* A8 */ "\xC2\xA8", /* B7 */ "\xC2\xB7", /* B9 */ "\xC2\xB9",
/* B3 */ "\xC2\xB3", /* B2 */ "\xC2\xB2", /* 25A0 */ "\xE2\x96\xA0", /* A0 */ "\xC2\xA0" };

std::string cp850toUTF8(const uint8_t *message, uint16_t len)
{
   std::string result;

   for (uint16_t i = 0; i < len; ++i) {
      result += cp8500toUTF8Map[message[i]];
   }

   return result;
}

